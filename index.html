<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="manifest" href="/text-thingy/manifest.json">
    <title>text (but cool)</title>
    <style>
        body {
         font-family: Arial, sans-serif;
         margin: 0;
         padding: 0;
         overflow: visible;
         background-color: #333;
         color: white;
        }

        .bold {
            font-weight: bold;
        }

        .highlight {
            background-color: yellow;
        }

        .wave {
            animation: decrease 1s infinite;
        }

        .fakeload {
            text-decoration: underline overline;
            animation: spin 0.5s infinite;
            animation-timing-function: linear;
        }

        .rainbowText {
            animation: text 3s infinite;
        }

        .rainbowBg {
            animation: bg 3s infinite;
        }

        .doesThings {
            display: inline-block;
            position: relative;
            transform-origin: center;
        }

        .spoiler {
            background-color: black;
            color: black;
            border-radius: 3px;
            padding: 2px;
        }

        .spoiler:hover {
            background-color: gray;
            color: white;
        }

        #movable-text {
            position: relative;
            display: inline-block;
            overflow: visible;
        }

        .extraSpoiler {
            background-color: #1CQD22;
            color: #1C1D22;
            border-radius: 3px;
            padding: 2px;
        }

        .extraSpoiler:hover {
            background-color: gray;
            color: white;
        }

        .caret {
           display: inline-block;
           animation: pulse 1s infinite;
           color: gray;
        }

        .reaction {
          display: inline-flex;
          align-items: center;
          gap: 5px;
          cursor: pointer;
          user-select: none;
          background-color: #2c2f33;
          color: white;
          padding: 5px 10px;
          border-radius: 8px;
          font-size: 1rem;
          transition: background-color 0.2s;
        }

        .reaction:hover {
         border-color: #23272a;
         }

  input[type="range"] {
    -webkit-appearance: none;
    width: 100px;
    height: 10px;
    background: #1D1C22;
    border-radius: 10px;
    outline: none;
  }
 input[type="range"]::-webkit-slider-runnable-track {
    background: #1D1C22;
    height: 10px;
    border-radius: 10px;
  }

  input[type="range"]::-moz-range-progress {
     background: #1D1C22;
     height: 10px;
     border-radius: 10px;
  }   

  input[type="range"]::-ms-fill-lower {
  background: #1D1C22; 
  }

        .reaction.active {
         border-color: #7289da;
         }

        .counter {
          font-weight: bold;
          font-size: 1.1rem;
        }        

        .upload-button {
          display: inline-block;
          background-color: #DDDDDD;
          color: white;
          padding: 2px 4px;
          border-radius: 5px;
          cursor: pointer;
          transition: background-color 0.2s;
        }

        .upload-button:hover {
          background-color: #AAAAAA;
         }

       .reaction-item img {
         width: 100%;
         height: 100%;   
         object-fit: cover;
       }

           @keyframes pulse {
           0% { opacity: 0; }
           50% { opacity: 1; }
           100% { opacity: 0; }
        }

        @keyframes decrease {
            0% { top: 0; }
            100% { top: -5px; }
        }

        @keyframes text {
            0% { color: red; }
            25% { color: blue; }
            50% { color: yellow; }
            75% { color: green; }
            100% { color: purple; }
        }

        @keyframes bg {
            0% { background-color: red; }
            25% { background-color: blue; }
            50% { background-color: yellow; }
            75% { background-color: green; }
            100% { background-color: purple; }
        }

        .content-editable {
            width: 100%;
            white-space: pre-wrap;  /* To preserve new lines and spaces */
            color: #8F9095;
        }

        .scale {
            display: inline-block;
            transform-origin: center;
        }

        .spin {
            animation: spin 1s infinite linear;
            display: inline-block;
            position: relative;
            transform-origin: center;
        }

        @keyframes spin {
            0% {transform: rotate(0deg;)}
            100% {transform: rotate(360deg);}
        }

        .console-window {
  display: none;
  width: 350px;
  height: 350px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #222;
  border: 2px solid #555;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
  padding: 10px;
  resize: both;
  overflow: auto;    
}

.countDisplay {
  background-color: #1D1C22;
  color: gray;
  padding: 5px;
  border-radius: 5px;
  text-decoration-line: underline;
  text-decoration-color: #1D1c22;
  }

.console-header {
  background-color: #444;
  padding: 10px;
  text-align: center;
  font-weight: bold;
  cursor: move;
}

.console-output {
  background-color: #111;
  padding: 10px;
  margin-bottom: 10px;
  height: calc(100% - 140px); /* Dynamically adjust height */
  overflow-y: auto;
  white-space: pre-wrap;
  font-family: monospace;
}

.console-input {
  background-color: #222;
  color: white;
  width: calc(100% - 24px);
  padding: 10px;
  border: none;
  font-family: monospace;
  font-size: 14px;
  border-radius: 5px;
  resize: none;
  text-decoration-line: underline;
  text-decoration-color: #1D1C22;
}

#output .log {
  color: #F2f3EE;
  background-color: #1d1c22;
}

#output .wrn {
  color: white;
  background-color: #ddaa00;
  border-radius: 50px;
}

#output .err {
  color: white;
  background-color: #ff5555;
  border-radius: 50px;
}

#output .dbg {
  color: #9cdcfe;
  background-color: gray;
}

#output .store {
  color: #c586c0;
  background-color: white;
}

#output .input {
  color: #d7ba7d;
}

#output .choice {
  color: #d7ba7d;
}

#output .random {
  color: #d7ba7d;
}

#output .unknown {
  color: #ff4500;
  display: inline-block;
  position: relative;
  transform-origin: center;
  animation: float 5s infinite;
}

@keyframes float {
  0% { top: -3px; }
  25% { top: 0px; }
  50% { top: 3px; }
  75% { top: 0px; }
}     

#level-maker-container {
    width: 250px;
    display: flex;
    flex-direction: column;
    align-items: center;
    background: #181818;
    border: 2px solid #444;
    border-radius: 8px;
    padding: 10px;
    box-sizing: border-box;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;
}

#toolbar {
    display: flex;
    gap: 5px;
    margin-bottom: 10px;
}

#toolbar button {
    background: #333;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-family: monospace;
    transition: background 0.3s ease;
}

#toolbar button.active {
    background: #666;
}

#grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    grid-template-rows: repeat(5, 1fr);
    gap: 3px;
    width: 100%;
    height: 250px;
    margin-bottom: 10px;
}

#grid div {
    background: #444;
    border: 1px solid #333;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 18px;
    font-weight: bold;
    color: white;
    cursor: pointer;
    user-select: none;
    transition: background 0.2s ease, transform 0.1s ease;
}

#grid div:hover {
    background: #555;
    transform: scale(1.05);
}

#mobile-controls {
    display: flex;
    justify-content: space-between;
    gap: 5px;
    margin-top: 10px;
}

#mobile-controls button {
    background: #333;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-family: monospace;
    transition: background 0.3s ease;
}

#map-data {
    margin-top: 10px;
    background: #222;
    color: white;
    padding: 10px;
    width: 100%;
    border-radius: 5px;
    font-family: monospace;
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow-wrap: break;
    }

.fake-ad {
    display: inline-block;
    position: relative;
    padding: 6px 10px;
    border: 2px solid red;
    color: white;
    font-size: 14px;
    font-weight: bold;
    font-family: Arial, sans-serif;
    text-align: center;
    box-shadow: 2px 2px 0px black;
    cursor: pointer;
    background-color: transparent;
    border-radius: 5px;
}

.ad-content {
    position: relative;
    z-index: 1;
}

.fake-ad::after {
    content: "‚úñ";
    position: absolute;
    top: -8px;
    right: -8px;
    width: 14px;
    height: 14px;
    background: red;
    color: white;
    font-size: 12px;
    font-weight: bold;
    text-align: center;
    line-height: 14px;
    border-radius: 50%;
    box-shadow: 1px 1px 0px black;
}

#editor {
    position: relative;
    overflow: hidden;
    resize: both;
    height: 100px;
    width: 80%;
    border: 2px solid #000;
    }

    #cursorSettings {
    position: absolute;
    top: 40px;
    right: 10px;
    background: #222;
    color: white;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
}

#cursorSettings input {
    width: 100%;
    margin: 5px 0;
}

::selection {
    background: var(--selection-bg, #555);
    color: var(--selection-text, white);
}

.content-editable {
    caret-color: var(--caret-color, white);
}

.caretcolor {
    color: var(--caret-color, white);
}

.selectedtext {
    background-color: var(--selection-bg, #555);
    color: var(--selection-text, white);
}

.single-line-comment {
  color: var(--single-line-comment-color, #888);
}

        .minimized-elements-container {
    position: fixed;
    top: 10px;
    left: 10px;
    display: inline;
    flex-direction: column;
    gap: 5px;
    z-index: 10000;
}

.minimized-button {
    background: #0d0c11;
    color: white;
    padding: 5px 10px;
    border: 1px solid white;
    border-radius: 5px;
    cursor: pointer;
    text-align: center;
    font-size: 14px;
}

        .draggable-element {
            position: absolute;
            border: 3px solid #ffffff;
            padding: 5px;
            width: 200px;
            background: #0d0c11;
            color: #ffffff;
            cursor: grab;
            z-index: 1000;
        }

        .window-handle {
            cursor: move;
        }

        .drag-handle {
            cursor: grab;
        }

        .minimize-handle {
            cursor: pointer;
        }

        .element-content {
            margin-top: 10px;
        }
    </style>
</head>
<body style="background-color:#1D1C22;">
<div id="minimized-elements" class="minimized-elements-container"></div>
        <div id="console" class="console-window" resizeable="true">
            <span class="close-button" id="closeButton" style="background-color:#555; color:white; padding:10px; width:100%; border:none; border-radius:5px; cursor:pointer; font-weight:bold;">‚úò</span>
            <div class="console-output" id="output">

                <div>‚ñÄ‚ñà‚ñÄ‚†Ä‚ñà‚ñë‚ñà‚†Ä‚ñà‚†Ä‚ñà‚ñÑ‚ñë‚ñà‚†Ä‚ñà‚ñÄ‚ñÄ‚†Ä‚ñà‚ñÑ‚ñà         ‚ñë‚ñà‚ñë‚†Ä‚ñà‚ñÄ‚ñà‚†Ä‚ñà‚†Ä‚ñà‚ñë‚ñÄ‚ñà‚†Ä‚ñà‚ñÑ‚ñà‚†Ä‚ñë‚ñà‚ñë</div> ‚ïê‚ïê‚ïê‚ïê‚†Äc‚†Äo‚†Än‚†Äs‚†Äo‚†Äl‚†Äe‚†Ä‚ïê‚ïê‚ïê‚ïê‚ïê

‚Äòhehe funny code thingy‚Äô - Wess64
            </div>
            <span>
                <input type="text" class="console-input" id="inputField" placeholder="type here or something..." style="background-color: transparent;">
                <span class="run-button" id="runButton" style="background-color:#555; color:white; padding:10px; width:100%; border:none; border-radius:5px; cursor:pointer; font-weight:bold;"> ≥·µò‚Åø ‚áó <span id="countDisplay" class="countDisplay">[ ]</span></span>
            </span>
        </div>

    <div class="draggable-element" style="top: 50px; left: 50px;">
        <span class="element-name">typing area</span>
        <span class="drag-handle">‚ú•</span>
        <span class="window-handle">ñ§Ç</span>
        <span class="minimize-handle">‚ï∫‚ï∏</span>
        <hr style="border-style: solid; border-color: #ffffff; margin: 4px 0;">
        <div class="element-content">
            <p id="editor" contenteditable="true" class="content-editable" style="background-color:#0D0C11; padding:5px; border-radius:5px;" placeholder="type here..."></p>
        </div>
    </div>

<div class="draggable-element" style="top: 800px; left: 300px;">
    <span class="element-name">shine clicker</span>
    <span class="drag-handle">‚ú•</span>
    <span class="window-handle">ñ§Ç</span>
    <span class="minimize-handle">‚îÄ</span>
    <hr style="border-style: solid; border-color: #ffffff; margin: 4px 0;">
    <div class="element-content">
        <div style="font-family: monospace; background-color: #0D0C11; padding: 10px; border-radius: 5px;">
            <div style="text-align: center; margin-bottom: 10px; background-color: black;">
                <button onclick="resetShineClicker()" 
        style="border:none; background-color:#ff5555; border-radius:5px; padding:5px; color:white; grid-column: span 2;">
    reset
</button>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span>‚ÉØ<span style="color: purple;">‚ÉØ‚ùñ‚É∞</span>: <span id="shine-count">0</span></span>
                <span>auto: x<span id="auto-click-count">0</span></span>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
                <button onclick="clickShine()" style="border:none; background-color:#1D1C22; border-radius:5px; padding:5px; color:white; grid-column: span 2;">click</button>
                <div style="border-top: 1px solid #555; padding-top: 5px; grid-column: span 2;"></div>
                <button onclick="buyAutoClicker()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;">auto-click [50 <span style="color: purple;">shines</span>]</button>
                <button onclick="buyClickBoost()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;">+click [100 <span style="color: purple;">shines</span>]</button>
                <button onclick="saveShines()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white; grid-column: span 2;">save shines</button>
            </div>
        </div>
    </div>
</div>

    <div class="draggable-element" style="top: 300px; left: 50px;">
        <span class="element-name">management</span>
        <span class="drag-handle">‚ú•</span>
        <span class="window-handle">ñ§Ç</span>
        <span class="minimize-handle">‚ï∫‚ï∏</span>
        <hr style="border-style: solid; border-color: #ffffff; margin: 4px 0;">
        <div class="element-content">
            <button onclick="exportContent()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;">‚á≤ ·µâÀ£·µñ·µí ≥·µó</button>
            <button onclick="triggerFileInput()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;">‚á± ·∂¶·µê·µñ·µí ≥·µó</button><br><br>
            <button onclick="copyToClipboard()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;">‚á≤ ·∂úÀ°·∂¶·µñ·µá·µí·µÉ ≥·µà ·µâÀ£·µñ·µí ≥·µó</button>
            <button onclick="showPasteArea()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;">‚á± ·∂úÀ°·∂¶·µñ·µá·µí·µÉ ≥·µà ·∂¶·µê·µñ·µí ≥·µó</button><br><br>
    <input type="file" id="file-input" onchange="importContent(event)" style="display:none;">
    <div id="paste-area" style="display:none; margin-top:10px;">
        <hr style="border-color:#0D0C11; border-radius:5px;">
        <textarea id="clipboard-text" style="width:100%; width: calc(100% - 10px); height:50px; border-radius:5px; background-color:#0D0C11; color:white; border:none; padding:5px;"></textarea>
        <button onclick="insertFromPasteArea()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white; margin-top:5px;">‚Çö‚Çê‚Çõ‚Çú‚Çë</button>
        <button onclick="hidePasteArea()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white; margin-top:5px;">ùí∏‚Çê‚Çôùí∏‚Çë‚Çó</button>
        <hr style="border-color:#0D0C11; border-radius:5px;">
        <br>
    </div>

            <button onclick="clearStorage()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px;">üóë</button>
            <button id="cursorSettingsBtn" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;"> ‚öô </button>
        </div>
    </div>
    
    <div class="draggable-element" style="top: 550px; left: 50px;">
        <span class="element-name">links</span>
        <span class="drag-handle">‚ú•</span>
        <span class="window-handle">ñ§Ç</span>
        <span class="minimize-handle">‚ï∫‚ï∏</span>
        <hr style="border-style: solid; border-color: #ffffff; margin: 4px 0;">
        <div class="element-content">
    <a href="https://github.com/Wess64/text-thingy/issues/1#issue-2751884494" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px;">Syntax</a>
    <a href="https://github.com/Wess64/text-thingy/issues/3#issue-2753645888" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px;">Exporting</a>
    <div id="custom-links-container" style="margin-top: 10px;"></div>
    <hr>
        <input type="text" id="new-link-title" placeholder="Link title" style="background-color:#0D0C11; color:white; border:none; border-radius:5px; padding:5px; flex-grow:1;"><br>
        <input type="text" id="new-link-url" placeholder="https://" style="background-color:#0D0C11; color:white; border:none; border-radius:5px; padding:5px; flex-grow:1;"><br>
        <button onclick="addCustomLink()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;">Add</button>
</div>

<span id="openButton" style="background-color:#555; color:white; padding:10px; width:100px; border:none; border-radius:5px; cursor:pointer; font-weight:bold; position:fixed; bottom:20px; right:20px;">·µí·µñ·µâ‚Åø ·∂ú·µí‚ÅøÀ¢·µíÀ°·µâ ‚§¥</span>

<div id="cursorSettings" style="display: none; position: absolute; background: #222; color: white; padding: 10px; border-radius: 5px;">
    <label>selection [ bg: <input type="color" id="selectionBg" style="width:25px; background-color:#1D1C22; border: none;"></label> text: <input type="color" id="selectionText" style="width:25px; background-color:#1D1C22; border: none;"></label><br>]
    <br>
    <label>caret: <input type="color" id="caretColor" style="width:25px; background-color:#1D1C22; border: none;"></label><br>
    <label>cursor: <input type="color" id="cursorColor" style="width:25px; background-color:#1D1C22; border: none;"></label><br>
    <hr style="border-color:#0D0C11; border-radius:5px;">
    <h2> // comments </h2>
    <label>/! color: <input type="color" id="singleLineCommentColor" style="width:25px; background-color:#1D1C22; border: none;"></label><br>
    <button onclick="resetCommentSettings()" style="margin-top: 5px; border: none; background-color: red; border-radius: 5px; padding: 5px; color: white;">‚Ü∫ Reset Comment Settings</button>
    <button id="resetCursorSettings" style="margin-top: 5px; border: none; background-color: red; border-radius: 5px; padding: 5px; color: white;">‚Ü∫ reset all</button>
    <hr style="border-color:#0D0C11; border-radius:5px;">
    <h1>preview</h1><br>
    <span class="selectedtext">selected</span><span class="caretcolor"> Ô∏≥</span>
    <br>
    or<br>
    <p id="editor" class="content-editable" contenteditable="true" style="padding:5px; border-radius:5px; resize: none; width: 100% - 10px; height: 20px;">test here</p>
    <hr style="border-color:#0D0C11; border-radius:5px;">
</div>
<script> document.addEventListener("DOMContentLoaded", () => {
    const settingsBtn = document.getElementById("cursorSettingsBtn");
    const settingsMenu = document.getElementById("cursorSettings");

function loadCommentSettings() {
  document.documentElement.style.setProperty("--single-line-comment-color", localStorage.getItem("singleLineCommentColor") || "#888");
  document.getElementById('singleLineCommentColor').value = localStorage.getItem("singleLineCommentColor") || "#888888";
}

function saveCommentSettings() {
  localStorage.setItem("singleLineCommentColor", document.getElementById('singleLineCommentColor').value);
  document.documentElement.style.setProperty("--single-line-comment-color", document.getElementById('singleLineCommentColor').value);
}

function resetCommentSettings() {
  localStorage.removeItem("singleLineCommentColor");
  loadCommentSettings();
}

document.getElementById('singleLineCommentColor').addEventListener('input', saveCommentSettings);

loadCommentSettings();

    // Color pickers
    const cursorColorInput = document.getElementById("cursorColor");
    const selectionBgInput = document.getElementById("selectionBg");
    const selectionTextInput = document.getElementById("selectionText");
    const caretColorInput = document.getElementById("caretColor");
    const resetBtn = document.getElementById("resetCursorSettings");

    // Load saved settings
    function loadSettings() {
        document.documentElement.style.setProperty("--cursor-color", localStorage.getItem("cursorColor") || "white");
        document.documentElement.style.setProperty("--selection-bg", localStorage.getItem("selectionBg") || "#555");
        document.documentElement.style.setProperty("--selection-text", localStorage.getItem("selectionText") || "white");
        document.documentElement.style.setProperty("--caret-color", localStorage.getItem("caretColor") || "white");

        cursorColorInput.value = localStorage.getItem("cursorColor") || "#ffffff";
        selectionBgInput.value = localStorage.getItem("selectionBg") || "#555555";
        selectionTextInput.value = localStorage.getItem("selectionText") || "#ffffff";
        caretColorInput.value = localStorage.getItem("caretColor") || "#ffffff";
    }

    // Save and apply new settings
    function saveSettings() {
        localStorage.setItem("cursorColor", cursorColorInput.value);
        localStorage.setItem("selectionBg", selectionBgInput.value);
        localStorage.setItem("selectionText", selectionTextInput.value);
        localStorage.setItem("caretColor", caretColorInput.value);

        document.documentElement.style.setProperty("--cursor-color", cursorColorInput.value);
        document.documentElement.style.setProperty("--selection-bg", selectionBgInput.value);
        document.documentElement.style.setProperty("--selection-text", selectionTextInput.value);
        document.documentElement.style.setProperty("--caret-color", caretColorInput.value);
    }

    // Reset settings
    resetBtn.addEventListener("click", () => {
        localStorage.removeItem("cursorColor");
        localStorage.removeItem("selectionBg");
        localStorage.removeItem("selectionText");
        localStorage.removeItem("caretColor");
        loadSettings();
    });

    // Apply changes on input
    cursorColorInput.addEventListener("input", saveSettings);
    selectionBgInput.addEventListener("input", saveSettings);
    selectionTextInput.addEventListener("input", saveSettings);
    caretColorInput.addEventListener("input", saveSettings);

    // Show/hide settings menu
    settingsBtn.addEventListener("click", () => {
        settingsMenu.style.display = settingsMenu.style.display === "none" ? "block" : "none";
    });

    // Close menu when clicking outside
    document.addEventListener("click", (event) => {
        if (!settingsMenu.contains(event.target) && event.target !== settingsBtn) {
            settingsMenu.style.display = "none";
        }
    });

    // Initialize settings
    loadSettings();
});
</script><textarea id="plain-text-box" style="display:none;"></textarea>
    <script>
      window.onload = function() {
        const savedText = localStorage.getItem('effectsText');
        const effectBox = document.getElementById('editor');

        if (savedText) {
          effectBox.innerHTML = savedText;
          updatePlainText();
        }

        effectBox.addEventListener('input', updatePlainText);
      };

      function updatePlainText() {
        const effectBox = document.getElementById('editor');
        const plainTextBox = document.getElementById('plain-text-box');

        plainTextBox.textContent = effectBox.innerText;
        localStorage.setItem('effectsText', effectBox.innerHTML);
      }

      function clearStorage() {
        localStorage.removeItem('effectsText');
        const effectBox = document.getElementById('editor');
        effectBox.innerHTML = '';  // Clear the content in the editor
        document.getElementById('plain-text-box').textContent = '';  // Clear the plain text as well
      }

      function exportContent() {
        const effectBox = document.getElementById('editor');
        const content = effectBox.innerHTML;  // Get the content of the editor

        const blob = new Blob([content], { type: 'text/plain' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'editor_content.txt';  // Set the default file name
        link.click();
      }

      // Function to trigger the file input when the "Import" button is clicked
      function triggerFileInput() {
        document.getElementById('file-input').click();
      }

      // Function to import the content from the uploaded file
      function importContent(event) {
        const file = event.target.files[0];

        if (file) {
          const reader = new FileReader();

          reader.onload = function(e) {
            const content = e.target.result;
            const effectBox = document.getElementById('editor');
            effectBox.innerHTML = content;  // Insert the content into the editor
            updatePlainText();
          };

          reader.readAsText(file);
        }
      }

      // Function to copy content to clipboard
      function copyToClipboard() {
        const effectBox = document.getElementById('editor');
        const content = effectBox.innerHTML; // Get the editor's content

        navigator.clipboard.writeText(content).then(() => {
          alert('copied!');
        }).catch(err => {
          alert('failed.. ', err);
        });
      }

      // Function to show the paste area
      function showPasteArea() {
        const pasteArea = document.getElementById('paste-area');
        pasteArea.style.display = 'block';
        }

      // Function to insert content from the paste area into the editor
      function insertFromPasteArea() {
        const clipboardText = document.getElementById('clipboard-text').value;
        const effectBox = document.getElementById('editor');
        effectBox.innerHTML = clipboardText;
        updatePlainText();
        hidePasteArea();
      }

      // Function to hide the paste area
      function hidePasteArea() {
        const pasteArea = document.getElementById('paste-area');
        pasteArea.style.display = 'none';
      }
    </script>
</body>
    <script>
const loadedEffects = []; // Stores all loaded effects

// Parse a .tgy file
function parseTGYFile(content) {
  const effect = { enabled: true }; // Effects are enabled by default

  // Extract fields using regex
  const effectNameMatch = content.match(/effectname: `\/`([\s\S]*?)`\\`/);
  const explanationMatch = content.match(/explanation: `\/`([\s\S]*?)`\\`/);
  const htmlMatch = content.match(/html \{\{([\s\S]*?)\}\}/);
  const parseMatch = content.match(/parse: `\/`([\s\S]*?)`\\`/);
  const dateMatch = content.match(/date: (.*?)\n/);
  const authorMatch = content.match(/author: (.*?)\n/);
  const imageMatch = content.match(/image \{\{([\s\S]*?)\}\}/);

  if (!effectNameMatch || !htmlMatch || !parseMatch) {
    throw new Error('Invalid .tgy file format');
  }

  effect.effectName = effectNameMatch[1].trim();
  effect.explanation = explanationMatch ? explanationMatch[1].trim() : '';
  effect.html = htmlMatch[1].trim();
  effect.parse = parseMatch[1].trim();
  effect.date = dateMatch ? dateMatch[1].trim() : '';
  effect.author = authorMatch ? authorMatch[1].trim() : '';
  effect.image = imageMatch ? imageMatch[1].trim() : '';

  return effect;
}

// Load a .tgy file
function loadEffect(tgyContent) {
  try {
    const effect = parseTGYFile(tgyContent);
    loadedEffects.push(effect);
    console.log(`Loaded effect: ${effect.effectName}`);
    renderEffectList(); // Update the UI
  } catch (error) {
    console.error('Error loading effect:', error);
    alert('Failed to load effect. Check the console for details.');
  }
}

// Apply all enabled effects to the text
function applyEffects(text) {
  let result = text;
  loadedEffects.forEach(effect => {
    if (effect.enabled) {
      try {
        const regex = new RegExp(effect.parse, 'g');
        result = result.replace(regex, effect.html);
      } catch (error) {
        console.error(`Error applying effect "${effect.effectName}":`, error);
      }
    }
  });
  return result;
}

// Render the effect list UI
function renderEffectList() {
  const effectList = document.getElementById('effect-list');
  if (!effectList) return; // Skip if the UI doesn't exist

  effectList.innerHTML = '';

  loadedEffects.forEach((effect, index) => {
    const li = document.createElement('li');
    li.innerHTML = `
      <div class="effect-preview">
        ${effect.image ? `<img src="${effect.image}" alt="Effect Image" style="border-style: dashed none dashed none; border-width: 5px; border-radius: 5px;  padding: none; transform: scale(0.5); right: 0%;">` : '‚â´'}
        <div>
          <div class="effect-name">${effect.effectName}</div>
          <div class="meta"><sup style="color: gray;">${effect.date} ${effect.author}</sup></div>
          <div class="explanation" style="color: blue; text-decoration: underline; text-decoration-color: #0D0C11;" onclick="alert('${effect.explanation.replace(/'/g, "\\'")}')">' ·µâÀ£·µñÀ°·µÉ‚Åø·µÉ·µó·∂¶·µí‚Åø ·µõ '</div>
        </div>
        <label>
          <input type="checkbox" ${effect.enabled ? 'checked' : ''} onchange="toggleEffect(${index})">
          Enable
        </label>
        <button onclick="removeEffect(${index})" style="border:none; background-color:#ff5555; border-radius:5px; padding:2px 5px; color:white; margin-left:10px;">‚úò</button>
      </div>
    `;
    effectList.appendChild(li);
  });
}

// Toggle an effect's enabled state
function toggleEffect(index) {
  loadedEffects[index].enabled = !loadedEffects[index].enabled;
  renderEffectList();
}

// Remove an effect
function removeEffect(index) {
  loadedEffects.splice(index, 1);
  renderEffectList();
}

// Handle file input for loading .tgy files
function handleFileLoad(event) {
  const file = event.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = (e) => {
      const tgyContent = e.target.result;
      loadEffect(tgyContent);
    };
    reader.readAsText(file);
  }
}

// Add the plugin system UI to the page
function addPluginUI() {
  const pluginUI = `  
    <div class="draggable-element" style="top: 800px; left: 50px;">
        <span class="element-name">custom effects</span>
        <span class="drag-handle">‚ú•</span>
        <span class="window-handle">‚ùê</span>
        <span class="minimize-handle">‚ï∫‚ï∏</span>
        <hr style="border-style: solid; border-color: #ffffff; margin: 4px 0;">
        <div class="element-content">
            <div id="plugin-manager">
                <ul id="effect-list"></ul>
                <input type="file" id="load-effect" accept=".tgy" onchange="handleFileLoad(event)" style="display:none;">
                <button onclick="document.getElementById('load-effect').click()" style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; color:white;">‚∏ï Load Effect</button>
            </div>
        </div>
    </div>
  `;
  document.body.insertAdjacentHTML('beforeend', pluginUI);
}

// Initialize the plugin system
addPluginUI();
renderEffectList();

// Function to parse content and apply effects
function parseContent(text) {
  // Apply loaded effects
  text = applyEffects(text);

  // **bold**
  text = text.replace(/\*\*(.*?)\*\*/g, '<span class="bold">$1</span> ');

  // ~~highlight~~
  text = text.replace(/~~(.*?)~~/g, '<span class="highlight">$1</span> ');

  // ``next``
  text = text.replace(/``(.*?)``/g, '<br>$1 ');

  // #button#
  text = text.replace(/#(.*?)#/g, '<button>$1</button> ');

  // _sub:_
  text = text.replace(/_sub:(.*?)_/g, '<sub>$1</sub> ');

  // _sup:_
  text = text.replace(/_sup:(.*?)_/g, '<sup>$1</sup> ');

  // @at@
  text = text.replace(/@(.*?)@/g, '<mark style="background-color:blue; color:white; border-radius:5px; padding:5px;">@$1</mark> ');

  // spoiler
  text = text.replace(/¬∞¬∞(.*?)¬∞¬∞/g, '<span class="spoiler">$1</span> ');
  text = text.replace(/_¬∞(.*?)_/g, '<span class="extraSpoiler">$1</span> ');

  // _1!(font)!_
  text = text.replace(/_1!(.*?)!_/g, '<code>$1</code> ');

  // _2!(strikethrough)!_
  text = text.replace(/_2!(.*?)!_/g, '<s>$1</s> ');

  // _3!(underline)!_
  text = text.replace(/_3!(.*?)!_/g, '<u>$1</u> ');

  // _4!(italic)!_
  text = text.replace(/_4!(.*?)!_/g, '<dfn>$1</dfn> ');

  // _scale:x?
  text = text.replace(/_scale:(\d+)?(.*?)_/g, '<span style="transform:scale($1);">$2</span> ');

  // funny arrow
  text = text.replace(/tarrow:"(.*?)"/g, '<span style="transform:rotate($1deg);" class="doesThings" contenteditable="false">‚û°Ô∏é</span> ');

  /* _?dropdown: */
  text = text.replace(/_?_dropdown:"(.*?)":"(.*?)":"(.*?)"/g, '<select id="$1"><option value="$1">$1</option><option value="$2">$2</option><option value="$3">$3</option></select> ');

  // _?summary:
  text = text.replace(/_?_?summary:"(.*?)":"(.*?)"/g, '<details><summary>$1</summary>$2</details> ');

  // _?reaction
  text = text.replace(/_?reaction:"(.*?)"/g, '<div class="reaction" data-count="0" onclick="toggleCounter(this)"><span class="label">$1</span><span class="counter">0</span></div> ');

  // _!emoji
  text = text.replace(/_?_!emoji/g, '<div class="reaction-system"><label class="upload-button"><abbr>‚•£</abbr><input type="file" accept="image/*" onchange="handleImageUpload(event)" hidden></label><div id="reaction-container"></div></div> ');

  // minigame
  text = text.replace(/_!!minigame1_/g, '<iframe src="checkboxbox.html" style="width:200px; height:200px; border:none; border-radius: 5px;" allowfullscreen="true"></iframe>');

  // _!marquee
  text = text.replace(/_?marquee:"(.*?)":(.*?)_/g, '<sup contenteditable="false">‚ïé</sup><marquee behavior="scroll" direction="$1" style="width:100px; height:20px; border:none; background-color:#0D0C11;">$2</marquee><sup contenteditable="false">‚ïé</sup> ');

  // _checkbox_
  text = text.replace(/_!checkbox_/g, '<input type="checkbox"> ');

            // _slider
            text = text.replace(/_?_?slider:"(.*?)":"(.*?)":"(.*?)"_/g, '<input type="range" min="$1" max="$2" value="$3"> ');

            // _switch
            text = text.replace(/_switch_/g, '<input type="range" min="0" max="1" value="0" style="width:30px;"> ');

            // ((extremely)) real ads (WILL get you money *wink wink*)
text = text.replace(/_!ad:(.*?)_/g, '<span class="fake-ad">$1</span>');

            // square
text = text.replace(/_!!square_/g, () => {
    // Create the square div dynamically
    const squareDiv = document.createElement('div');
    squareDiv.id = 'square';
    squareDiv.innerHTML = '';
    squareDiv.style.position = 'absolute';
    squareDiv.style.width = '40px';
    squareDiv.style.height = '40px';
    squareDiv.style.backgroundColor = 'red';
    squareDiv.style.color = 'white';
    squareDiv.style.textAlign = 'center';
    squareDiv.style.lineHeight = '20px';
    squareDiv.style.cursor = 'grab';
    squareDiv.style.borderRadius = '5px';
    squareDiv.style.zIndex = '10000'; // Ensure it's on top of other elements

    // Append square to the body (not to the text container)
    document.body.appendChild(squareDiv);

    // Initialize square movement functionality
    const square = squareDiv;
    let x = 100, y = 100, velocityX = 0, velocityY = 0;
    const gravity = 0.8;
    const friction = 0.98;
    const bounce = -0.7;
    const screenWidth = window.innerWidth;
    const screenHeight = window.innerHeight;
    let isDragging = false;
    let dragOffsetX = 0, dragOffsetY = 0;
    let lastMouseX = 0, lastMouseY = 0;

    // Dragging logic
    square.addEventListener('mousedown', (e) => {
        isDragging = true;
        dragOffsetX = e.clientX - x;
        dragOffsetY = e.clientY - y;
        square.style.cursor = 'grabbing';
        lastMouseX = e.clientX;
        lastMouseY = e.clientY;
    });

    document.addEventListener('mousemove', (e) => {
        if (isDragging) {
            x = e.clientX - dragOffsetX;
            y = e.clientY - dragOffsetY;

            // Calculate velocity based on drag movement
            velocityX = e.clientX - lastMouseX;
            velocityY = e.clientY - lastMouseY;

            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
        }
    });

    document.addEventListener('mouseup', () => {
        isDragging = false;
        square.style.cursor = 'grab';
    });

    // Touch support
    square.addEventListener('touchstart', (e) => {
        const touch = e.touches[0];
        isDragging = true;
        dragOffsetX = touch.clientX - x;
        dragOffsetY = touch.clientY - y;
        lastMouseX = touch.clientX;
        lastMouseY = touch.clientY;
    });

    document.addEventListener('touchmove', (e) => {
        if (isDragging) {
            const touch = e.touches[0];
            x = touch.clientX - dragOffsetX;
            y = touch.clientY - dragOffsetY;

            // Calculate velocity based on drag movement
            velocityX = touch.clientX - lastMouseX;
            velocityY = touch.clientY - lastMouseY;

            lastMouseX = touch.clientX;
            lastMouseY = touch.clientY;
        }
    });

    document.addEventListener('touchend', () => {
        isDragging = false;
    });

    // Gravity and collision logic
    function update() {
        if (!isDragging) {
            // Apply gravity
            velocityY += gravity;

            // Update position with velocity
            x += velocityX;
            y += velocityY;

            // Wall collisions
            if (x < 0 || x + square.offsetWidth > screenWidth) {
                velocityX *= bounce;
                x = Math.max(0, Math.min(x, screenWidth - square.offsetWidth));
            }

            // Bottom collision
            if (y + square.offsetHeight > screenHeight) {
                velocityY *= bounce;
                y = screenHeight - square.offsetHeight;
            }

            // Apply friction to simulate natural slowing down
            velocityX *= friction;
            velocityY *= friction;
        }

        // Update square position
        square.style.left = `${x}px`;
        square.style.top = `${y}px`;

        requestAnimationFrame(update);
    }

    // Start the animation
    update();

    return ''; // Return empty string for replacement
});

text = text.replace(/_!!mysquare:\{\s*([\s\S]*?)\}_/g, (_, params) => {
    const defaults = {
        size: "40x40",
        bgcolor: "red",
        textcolor: "white",
        content: "",
        gravity: 0.8,
        friction: 0.98,
        bounce: -0.7,
        horizontalSpeed: 0,
        group: "default",
    };

    const options = { ...defaults };

    // Parse command parameters
    params.split(/\s*,\s*/).forEach(param => {
        const [key, value] = param.split(/\s*:\s*/);
        if (key === "size") {
            const [width, height] = value.split(/\s*x\s*/).map(Number);
            options.width = width || parseInt(defaults.size.split("x")[0]);
            options.height = height || parseInt(defaults.size.split("x")[1]);
        } else if (key === "content") {
            options.content = value.trim().slice(1, -1); // Remove backticks
        } else {
            options[key] = value.trim();
        }
    });

    const squareDiv = document.createElement("div");
    squareDiv.style.position = "absolute";
    squareDiv.style.rotation = "2px";
    squareDiv.style.width = `${options.width}px`;
    squareDiv.style.height = `${options.height}px`;
    squareDiv.style.backgroundColor = options.bgcolor;
    squareDiv.style.color = options.textcolor;
    squareDiv.style.textAlign = "center";
    squareDiv.style.lineHeight = `${options.height}px`;
    squareDiv.style.cursor = "grab";
    squareDiv.style.borderRadius = "5px";
    squareDiv.style.zIndex = "10000";
    squareDiv.textContent = options.content;

    document.body.appendChild(squareDiv);

    let x = 100,
        y = 100,
        velocityX = 0,
        velocityY = 0;
    const gravity = parseFloat(options.gravity);
    const friction = parseFloat(options.friction);
    const bounce = parseFloat(options.bounce);
    const horizontalSpeed = parseFloat(options.horizontalSpeed);
    const screenWidth = window.innerWidth;
    const screenHeight = window.innerHeight;
    let isDragging = false,
        dragOffsetX = 0,
        dragOffsetY = 0;
    let lastMouseX = 0,
        lastMouseY = 0;

    // Fix: Improved Dragging Logic for both mouse and touch events
    function startDragging(e) {
        isDragging = true;
        const clientX = e.clientX || e.touches[0].clientX;
        const clientY = e.clientY || e.touches[0].clientY;
        dragOffsetX = clientX - x;
        dragOffsetY = clientY - y;
        squareDiv.style.cursor = "grabbing";  // Change cursor while dragging

        // Prevent default to stop text selection and other behaviors
        e.preventDefault();
    }

    // Handle mouse/touch movements for dragging
    function moveDragging(e) {
        if (isDragging) {
            const clientX = e.clientX || e.touches[0].clientX;
            const clientY = e.clientY || e.touches[0].clientY;
            x = clientX - dragOffsetX;
            y = clientY - dragOffsetY;

            // Calculate velocity based on drag movement
            velocityX = clientX - lastMouseX;
            velocityY = clientY - lastMouseY;

            lastMouseX = clientX;
            lastMouseY = clientY;
        }
    }

    function stopDragging() {
        isDragging = false;
        squareDiv.style.cursor = "grab";
    }

    squareDiv.addEventListener("mousedown", startDragging);
    squareDiv.addEventListener("touchstart", startDragging);

    document.addEventListener("mousemove", moveDragging);
    document.addEventListener("touchmove", moveDragging);

    document.addEventListener("mouseup", stopDragging);
    document.addEventListener("touchend", stopDragging);
    document.addEventListener("touchcancel", stopDragging);

    // Gravity and collision logic
    function update() {
        if (!isDragging) {
            velocityY += gravity;
            x += velocityX;
            y += velocityY;

            if (horizontalSpeed !== 0) {
                x += horizontalSpeed;  // Move horizontally by the specified speed
            }

            if (x < 0 || x + squareDiv.offsetWidth > screenWidth) {
                velocityX *= bounce;
                x = Math.max(0, Math.min(x, screenWidth - squareDiv.offsetWidth));
            }

            if (y + squareDiv.offsetHeight > screenHeight) {
                velocityY *= bounce;
                y = screenHeight - squareDiv.offsetHeight;
            }

            velocityX *= friction;
            velocityY *= friction;
        }

        squareDiv.style.left = `${x}px`;
        squareDiv.style.top = `${y}px`;

        squareDiv.style.width = `${options.width}px`;
        squareDiv.style.height = `${options.height}px`;

        requestAnimationFrame(update);
    }

    update();

    return "";
});

            // spin
            text = text.replace(/_!spin:(.*?)_/g, '<span class="spin">$1</span> ');

            // list with funny numbers
text = text.replace(/_ol:("(.*?)"(?::"(.*?)")*)_/g, function(_, list) {
    let items = list.split(':"').map(item => item.replace(/"/g, ''));
    return `<ol>` + items.map(item => `<li>${item}</li>`).join('') + `</ol `;
});

// list with ‚Ä¢
text = text.replace(/_ul:("(.*?)"(?::"(.*?)")*)_/g, function(_, list) {
    let items = list.split(':"').map(item => item.replace(/"/g, ''));
    return `<ul>` + items.map(item => `<li>${item}</li>`).join('') + `</ul><br>`;
});

// _abbr:_
text = text.replace(/_abbr:"(.*?)":"(.*?)"_/g, '<abbr title="$2">$1</abbr> ');

// voice thibg
text = text.replace(/_voice:"(.*?)"_/g, function(_, title) {
    return `<abbr title="${title}" class="voice-icon">üé§</abbr> `;
});

// fakeload
text = text.replace(/_fakeload_/g, '<span class="spin" class="fakeload">‚ü≥</span> ');

// hr and br things
text = text.replace(/_hr_/g, '<br><hr style="border-color:#0D0C11; border-radius:5px;"><br> ');
text = text.replace(/_br_/g, '<br> ');

    text = text.replace(/\/!.*$/gm, '<span class="single-line-comment">$&</span> ');
    text = text.replace(/\/\?.*$/gm, '<span class="single-line-comment">$&</span> ');

//   if your bored of my stupid effects,
//              do it yourself

            return text;
        }

        function saveSelection(containerEl) {
            let selection = window.getSelection();
            if (selection.rangeCount === 0) return null;

            let range = selection.getRangeAt(0);
            let preCaretRange = range.cloneRange();
            preCaretRange.selectNodeContents(containerEl);
            preCaretRange.setEnd(range.endContainer, range.endOffset);

            return preCaretRange.toString().length; 
        }

        function restoreSelection(containerEl, savedPosition) {
    let nodeStack = [containerEl], charCount = 0, range = document.createRange(), foundStart = false;
    range.setStart(containerEl, 0);
    range.collapse(true);

    while (nodeStack.length > 0) {
        let node = nodeStack.pop();

        if (node.nodeType === 3) {  // Text node
            let nextCharCount = charCount + node.length;
            if (!foundStart && savedPosition >= charCount && savedPosition <= nextCharCount) {
                range.setStart(node, savedPosition - charCount);
                foundStart = true;
            }
            charCount = nextCharCount;
        } else {
            let childNodes = node.childNodes;
            for (let i = childNodes.length - 1; i >= 0; i--) {
                nodeStack.push(childNodes[i]);
            }
        }
    }

    let sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);  // Correctly add the range
}
 document.getElementById('editor').addEventListener('input', function () {
            let editor = this;
            let content = editor.innerHTML;

            // Save cursor position
            let cursorPos = saveSelection(editor);

            // parse the content for **bold**, __italic__, and ~~highlight~~
            let parsedContent = parseContent(content);

            if (parsedContent !== content) {
                editor.innerHTML = parsedContent; 
            }

            restoreSelection(editor, cursorPos);
        });

        function showContent() {
            let content = document.getElementById('editor').innerHTML;
            alert(content);
        }

        function toggleCounter(element) {
         const counter = element.querySelector('.counter');
          let count =         parseInt(element.getAttribute('data-count'), 10) || 0;

       if (count === 0) {
         count = 1;
    element.classList.add('active');
       } else {
         count = 0;
       element.classList.remove('active');
       }

  counter.textContent = count;
  element.setAttribute('data-count', count);
}

     function handleImageUpload(event) {
  const file = event.target.files[0];
  const uploadButton = event.target.parentElement;

  if (file) {
    const reader = new FileReader();

    reader.onload = function (e) {
      replaceButtonWithImage(uploadButton, e.target.result);
    };

    reader.readAsDataURL(file);
  }
}

function handleImageUpload(event) {
  const file = event.target.files[0];
  const uploadButton = event.target.parentElement;

  if (file) {
    const reader = new FileReader();

    reader.onload = function (e) {
      replaceButtonWithImage(uploadButton, e.target.result);
    };

    reader.readAsDataURL(file);
  }
}

function replaceButtonWithImage(buttonElement, imageSrc) {
  const img = document.createElement('img');
  img.src = imageSrc;
  img.alt = 'custom emoji';
  img.style.width = '15px';
  img.style.height = '15px';
  img.style.borderRadius = '0px';
  img.style.objectFit = 'cover';
  img.style.display = 'inline-block'; // Ensure the image stays inline

  const parent = buttonElement.parentElement;

  // Ensure the parent maintains inline behavior
  parent.style.display = 'inline-flex';
  parent.style.alignItems = 'center';

  parent.replaceChild(img, buttonElement);
}

const inputField = document.getElementById('inputField');
const outputArea = document.getElementById('output');
const runButton = document.getElementById('runButton');
const closeButton = document.getElementById('closeButton');
const openButton = document.getElementById('openButton');
const importFileInput = document.getElementById('importFileInput');

let storedValue = localStorage.getItem('storedValue') || null; // Load stored value from local storage
let userInput = null;
let scriptContent = '';
let warnCount = 0;
let errorCount = 0;

// Initialize stored value display
function initializeStoredValue() {
  if (storedValue) {
    appendToOutput(`‚Ü∫ ${storedValue}`, 'store');
  }
}

// Execute Command Function
function executeCommand(command) {
  const [cmd, ...args] = command.split(' ');
  scriptContent += `${command}\n`; // Add command to the script content for export

  let message = replacePlaceholders(args.join(' ')); // Replace placeholders
  let messageClass = ''; // CSS class for styling

  switch (cmd) {
    case 'help':
      messageClass = 'help';
      message = `‚îÄ‚ïê commands ‚ïê‚îÄ
      ùô°ùô§ùôú ‚îÑ logs a message
      log ùòµùò¶ùòπùòµ
      
      ùô¨ùôßùô£ ‚îÑ writes a warning message
      wrn ùòµùò¶ùòπùòµ
      
      ùôöùôßùôß ‚îÑ writes an error message
      err ùòµùò¶ùòπùòµ
      
      ùôôùôóùôú ‚îÑ writes an debug message
      dbg ùòµùò¶ùòπùòµ
      
      ùôòùô°ùôß ‚îÑ clears the console
      clr
      
      ùô®ùô©ùô§ùôßùôö ‚îÑ stores a value locally
      store ùòµùò¶ùòπùòµ
      \\stored\\ to write the stored value (any command)

      ùôßùôöùô•ùôöùôñùô© ‚îÑ repeats a command
      repeat ùòØùò∂ùòÆùò£ùò¶ùò≥ ùôòùô§ùô¢ùô¢ùôñùô£ùôô
           
      ùôûùô£ùô•ùô™ùô© ‚îÑ get input from the user in a popup (with optionally being able to write text in the popup)
      input 'ùòµùò¶ùòπùòµ'
      \\input\\ to get the value the user inputted
           
      ùôòùôùùô§ùôûùôòùôö ‚îÑ get a yes/no input from the user (with optionally being able to write text in the popup)
      choice 'ùòµùò¶ùòπùòµ'
      
      ùô•ùô§ùô•ùô™ùô• ‚îÑ show a popup with text in it
      popup 'ùòµùò¶ùòπùòµ'
      
      ùôßùôñùô£ùôôùô§ùô¢ ‚îÑ generates a random number from a range
      random ùòØùò∂ùòÆùò£ùò¶ùò≥ ùòØùò∂ùòÆùò£ùò¶ùò≥
      
      ùôßùôöùô®ùôöùô© ‚îÑ resets either the stored value or the inputted value
      reset [stored|input]
      `;
      warnCount++;
      break;
    case 'log':
      messageClass = 'log';
      break;
    case 'wrn':
      messageClass = 'wrn';
      message = `‚ö†‚ñ∂ ${message}`;
      warnCount++;
      break;
    case 'err':
      messageClass = 'err';
      message = `‚úò‚ñ∂ ${message}`;
      errorCount++;
      break;
    case 'clr': 
      outputArea.innerHTML = '';
      errorCount = 0;
      warnCount = 0;
      updateCountDisplay();
      return;
    case 'store': 
      storedValue = message; // Update the value
      localStorage.setItem('storedValue', storedValue); // Save to local storage
      messageClass = 'store';
      message = `‚å®Ô∏éÔ∏é: ${storedValue}`;
      break;
    case 'reset': // Reset stored or input
      const resetTarget = args[0] || 'both';
      if (resetTarget === 'stored' || resetTarget === 'both') {
        storedValue = null;
        localStorage.removeItem('storedValue'); // Remove from local storage
        appendToOutput(`‚òí‚ñ∂ deleted stored value`, 'reset');
      }
      if (resetTarget === 'input' || resetTarget === 'both') {
        userInput = null;
        appendToOutput(`‚òí‚ñ∂ deleted user input`, 'reset');
      }
      return;
    case 'repeat':
      const repeatTimes = parseInt(args[0], 10);
      const repeatCommand = args.slice(1).join(' ');
      if (!isNaN(repeatTimes) && repeatCommand) {
        for (let i = 0; i < repeatTimes; i++) {
          executeCommand(repeatCommand);
        }
      } else {
        messageClass = 'err';
        message = `‚ö†Ô∏é (you have to provide a number)`;
      }
      return; 
    case 'popup':
    const popupMessage = args.join(' ').replace(/['"]+/g, '');
    if (popupMessage) {
        alert(popupMessage); // Display a popup alert
        messageClass = 'popup';
    } else {
        messageClass = 'err';
        message = `‚ö†Ô∏é no message!)`;
    }
    break;

case 'input':
    const inputPromptMessage = args.join(' ').replace(/['"]+/g, '');
    userInput = prompt(inputPromptMessage || 'Please input a value:');
    if (userInput !== null) {
        messageClass = 'input';
        message = `‚å®Ô∏éÔ∏é "${userInput}"`;
    } else {
        messageClass = 'err';
        message = `‚ö†Ô∏é no input!`;
    }
    break;

case 'choice':
    const choiceMessage = args.join(' ').replace(/['"]+/g, '');
    const userChoice = confirm(choiceMessage || 'confirm?');
    if (userChoice) {
        messageClass = 'confirm';
        message = `[‚úî] ${choiceMessage}`;
    } else {
        messageClass = 'confirm';
        message = `[‚úò] ${choiceMessage}`;
    }
    break;
   case 'random':
    const min = parseInt(args[0], 10);
    const max = parseInt(args[1], 10);
    if (!isNaN(min) && !isNaN(max) && min <= max) {
        const randomValue = Math.floor(Math.random() * (max - min + 1)) + min;
        messageClass = 'random';
        message = `‚öÉ: ${randomValue}`;
    } else {
        messageClass = 'err';
        message = `‚ö†Ô∏é Invalid random range (min must be < max)`;
    }
    break;
    default:
      messageClass = 'unknown';
      message = ` ‚ÅâÔ∏è‚ñ∂ |${command}| `;
  }

  function updateCountDisplay() {
    const countDisplay = document.getElementById('countDisplay');
    countDisplay.textContent = `[‚ö†Ô∏é: ${warnCount}, ‚úò: ${errorCount}]`;
  }

  appendToOutput(message, messageClass);
  updateCountDisplay();
  inputField.value = '';  
}

function appendToOutput(message, messageClass) {
  const messageElement = document.createElement('div');
  messageElement.className = messageClass;
  messageElement.innerHTML = message;
  outputArea.appendChild(messageElement);
  outputArea.scrollTop = outputArea.scrollHeight;
}

function replacePlaceholders(command) {
  return command
    .replace(/\\stored\\/g, storedValue || '(nothing stored)')
    .replace(/\\input\\/g, userInput || '(nothing inputted)');
}

function exportScript() {
  const blob = new Blob([scriptContent], { type: 'text/plain' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'console_script.txt';
  link.click();
}

// Event Listeners
runButton.addEventListener('click', function () {
  const command = inputField.value.trim();
  if (command) executeCommand(command);
});

// Close Console
closeButton.addEventListener('click', function () {
  document.getElementById('console').style.display = 'none';
  openButton.style.display = 'block'; 
});

// Open Console
openButton.addEventListener('click', function () {
  document.getElementById('console').style.display = 'block';
  openButton.style.display = 'none'; 
});

// Initialize stored value on page load
initializeStoredValue();

// Window Management System
const fonts = ['Arial', 'Courier New', 'Georgia', 'Verdana', 'Comic Sans MS'];
let draggedElement = null;
let offsetX = 0, offsetY = 0;

function getRandomFont() {
    const fonts = [    
        'Arial', 'Helvetica', 'Times New Roman', 'Courier New', 'Verdana', 'Georgia',
        'Tahoma', 'Trebuchet MS', 'Impact', 'Comic Sans MS', 'Lucida Console', 'Palati                no'];
    return fonts[Math.floor(Math.random() * fonts.length)];
}

// Minimize Functionality
document.addEventListener('click', (e) => {
    if (e.target.classList.contains('minimize-handle')) {
        const element = e.target.closest('.draggable-element');
        minimizeElement(element);
    }
});

function minimizeElement(element) {
    const minimizedButton = document.createElement('div');
    minimizedButton.className = 'minimized-button';
    minimizedButton.textContent = element.querySelector('.element-name').textContent;

    // Apply random font only for the "custom effects" window
    if (element.querySelector('.element-name').textContent === 'custom effects') {
        minimizedButton.style.fontFamily = getRandomFont();
    }

    minimizedButton.addEventListener('click', () => {
        element.style.display = 'block';
        minimizedButton.remove();
        if (element.querySelector('#editor')) {
            element.querySelector('#editor').setAttribute('contenteditable', 'true');
        }
    });

    // Add the minimized button to the container
    const minimizedContainer = document.getElementById('minimized-elements');
    minimizedContainer.appendChild(minimizedButton);
    element.style.display = 'none';

    // Disable text area for the typing area window
    if (element.querySelector('#editor')) {
        element.querySelector('#editor').setAttribute('contenteditable', 'false');
    }
}

// Drag and Drop Functionality
function startDragging(e) {
    const handle = e.target;
    if (handle.classList.contains('drag-handle') || handle.classList.contains('window-handle')) {
        draggedElement = handle.closest('.draggable-element');
        const rect = draggedElement.getBoundingClientRect();

        // Calculate offset based on touch or mouse event
        if (e.type === 'touchstart') {
            offsetX = e.touches[0].clientX - rect.left;
            offsetY = e.touches[0].clientY - rect.top;
        } else {
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;
        }

        draggedElement.style.cursor = 'grabbing';
    }
}

function moveDragging(e) {
    if (draggedElement) {
        let clientX, clientY;

        // Get coordinates from touch or mouse event
        if (e.type === 'touchmove') {
            clientX = e.touches[0].clientX;
            clientY = e.touches[0].clientY;
        } else {
            clientX = e.clientX;
            clientY = e.clientY;
        }

        // Calculate new position based on mouse/touch coordinates and offset
        const newX = clientX - offsetX;
        const newY = clientY - offsetY;

        // Ensure the window stays within the viewport
        const maxX = window.innerWidth - draggedElement.offsetWidth;
        const maxY = window.innerHeight - draggedElement.offsetHeight;

        draggedElement.style.left = `${Math.min(Math.max(newX, 0), maxX)}px`;
        draggedElement.style.top = `${Math.min(Math.max(newY, 0), maxY)}px`;
    }
}

function stopDragging() {
    if (draggedElement) {
        draggedElement.style.cursor = 'grab';
        draggedElement = null;
    }
}

// Add event listeners for mouse and touch events
document.addEventListener('mousedown', startDragging);
document.addEventListener('mousemove', moveDragging);
document.addEventListener('mouseup', stopDragging);

document.addEventListener('touchstart', startDragging, { passive: false });
document.addEventListener('touchmove', moveDragging, { passive: false });
document.addEventListener('touchend', stopDragging);

// Window Mode Toggle
document.addEventListener('click', (e) => {
    if (e.target.classList.contains('window-handle')) {
        const element = e.target.closest('.draggable-element');
        element.classList.toggle('window-mode');
        if (element.classList.contains('window-mode')) {
            element.style.position = 'fixed';
            element.style.top = '50px';
            element.style.left = '50px';
            element.style.zIndex = '1000';
            element.style.cursor = 'move';
        } else {
            element.style.position = 'absolute';
            element.style.cursor = 'grab';
        }
    }
});

let shines = 0;
let clickValue = 1;
let autoClickers = 0;
let autoClickInterval;

function resetShineClicker() {
    if (confirm("you sure you want to reset ùë®ùë≥ùë≥ ùòÄùóµùó∂ùóªùó≤ ùó∞ùóπùó∂ùó∞ùó∏ùó≤ùóø progress? this cannot be undone!")) {
        shines = 0;
        clickValue = 1;
        autoClickers = 0;
        clearInterval(autoClickInterval);
        
        localStorage.removeItem('shineClicker');
        updateShineDisplay();
        alert("‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë resetted ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë");
    }
}

function loadShines() {
    const saved = localStorage.getItem('shineClicker');
    if (saved) {
        const data = JSON.parse(saved);
        shines = data.shines || 0;
        clickValue = data.clickValue || 1;
        autoClickers = data.autoClickers || 0;
        updateShineDisplay();
        startAutoClicker();
    }
}

function saveShines() {
    // Don't save if we're at zero (after reset)
    if (shines === 0 && clickValue === 1 && autoClickers === 0) {
        localStorage.removeItem('shineClicker');
        return;
    }
    
    const data = {
        shines: Math.min(shines, 5000),
        clickValue: clickValue,
        autoClickers: autoClickers
    };
    localStorage.setItem('shineClicker', JSON.stringify(data));
}

function updateShineDisplay() {
    document.getElementById('shine-count').textContent = Math.min(shines, 5000);
    document.getElementById('auto-click-count').textContent = autoClickers;
}

function clickShine() {
    shines += clickValue;
    if (shines > 5000) shines = 5000;
    updateShineDisplay();
    
    const clickEffect = document.createElement('div');
    clickEffect.textContent = '‚ÉØ‚ùñ‚É∞';
    clickEffect.style.position = 'absolute';
    clickEffect.style.left = `${Math.random() * 100}px`;
    clickEffect.style.animation = 'shineClick 1s forwards';
    document.querySelector('.element-content').appendChild(clickEffect);
    setTimeout(() => clickEffect.remove(), 1000);
}

function startAutoClicker() {
    clearInterval(autoClickInterval);
    if (autoClickers > 0) {
        autoClickInterval = setInterval(() => {
            shines += autoClickers;
            if (shines > 5000) shines = 5000;
            updateShineDisplay();
        }, 1000);
    }
}

function buyAutoClicker() {
    if (shines >= 50) {
        shines -= 50;
        autoClickers++;
        updateShineDisplay();
        startAutoClicker();
    } else {
        alert("Need more ‚ÉØ‚ùñ‚É∞!");
    }
}

function buyClickBoost() {
    if (shines >= 100) {
        shines -= 100;
        clickValue++;
        updateShineDisplay();
    } else {
        alert("Need more ‚ÉØ‚ùñ‚É∞!");
    }
}

function saveWindowStates() {
    const windows = document.querySelectorAll('.draggable-element');
    const windowStates = [];
    
    windows.forEach(window => {
        windowStates.push({
            id: window.querySelector('.element-name').textContent,
            x: window.style.left,
            y: window.style.top,
            rotation: window.dataset.rotation || '0',
            width: window.style.width || 'auto',
            height: window.style.height || 'auto'
        });
    });
    
    localStorage.setItem('windowStates', JSON.stringify(windowStates));
}

function loadWindowStates() {
    const saved = localStorage.getItem('windowStates');
    if (saved) {
        const windowStates = JSON.parse(saved);
        
        windowStates.forEach(state => {
            const window = [...document.querySelectorAll('.draggable-element')].find(
                w => w.querySelector('.element-name').textContent === state.id
            );
            
            if (window) {
                window.style.left = state.x;
                window.style.top = state.y;
                window.style.width = state.width;
                window.style.height = state.height;
                
                if (state.rotation !== '0') {
                    window.style.transform = `rotate(${state.rotation}deg)`;
                    window.dataset.rotation = state.rotation;
                }
            }
        });
    }
}

document.querySelectorAll('.element-name').forEach(title => {
    title.contentEditable = true;
    title.addEventListener('focus', () => {
        if (!title.dataset.originalText) {
            title.dataset.originalText = title.textContent;
        }
    });
    title.addEventListener('blur', () => {
        if (title.textContent.trim() === '') {
            title.textContent = title.dataset.originalText;
        }
        saveWindowStates();
    });
    title.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            e.preventDefault();
            title.blur();
        }
    });
});

function createShineParticles() {
    for (let i = 0; i < 20; i++) {
        setTimeout(() => createParticle(), i * 300);
    }
    
    setInterval(() => {
        if (Math.random() > 0.7) createParticle();
    }, 2000);
}

function createParticle() {
    const particle = document.createElement('div');
    particle.textContent = '‚ÉØ‚ùñ‚É∞';
    particle.style.position = 'absolute';
    particle.style.top = '-50px';
    particle.style.left = `${Math.random() * 100}%`;
    particle.style.fontSize = `${Math.random() * 10 + 10}px`;
    particle.style.opacity = '0.7';
    particle.style.animation = `fall ${Math.random() * 10 + 10}s linear infinite`;
    particle.style.transform = `rotate(${Math.random() * 360}deg)`;
    
    document.getElementById('shine-particles').appendChild(particle);
    setTimeout(() => particle.remove(), 15000);
}

document.addEventListener('DOMContentLoaded', () => {
    const style = document.createElement('style');
    style.textContent = `
        @keyframes shineClick { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(3); opacity: 0; } }
        @keyframes fall { 0% { transform: translateY(-50px) rotate(0deg); opacity: 0; } 10% { opacity: 0.7; } 90% { opacity: 0.7; } 100% { transform: translateY(calc(100vh + 50px)) rotate(360deg); opacity: 0; } }
        .rotate-handle:hover { animation: spin 1s infinite linear; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .resize-handle:hover { color: #b162e8; }
        .draggable-element { transition: transform 0.2s ease; min-width: 150px; min-height: 100px; }
    `;
    document.head.appendChild(style);

    loadWindowStates();
    loadShines();
    createShineParticles();
    
    setInterval(() => {
        saveWindowStates();
        saveShines();
    }, 5000);
    window.addEventListener('beforeunload', () => {
        saveWindowStates();
        saveShines();
    });
});

// Load custom links from localStorage
function loadCustomLinks() {
    const links = JSON.parse(localStorage.getItem('customLinks')) || [];
    const container = document.getElementById('custom-links-container');
    container.innerHTML = '';
    
    links.forEach(link => {
        const linkElement = document.createElement('div');
        linkElement.style.display = 'flex';
        linkElement.style.gap = '5px';
        linkElement.style.marginTop = '5px';
        
        linkElement.innerHTML = `
            <a href="${link.url}" 
               style="border:none; background-color:#0D0C11; border-radius:5px; padding:5px; flex-grow:1;">
                ${link.title}
            </a>
            <button onclick="removeCustomLink('${link.id}')" 
                    style="border:none; background-color:#ff5555; border-radius:5px; padding:5px; color:white;">
                √ó
            </button>
        `;
        
        container.appendChild(linkElement);
    });
}

// Add new custom link
function addCustomLink() {
    const titleInput = document.getElementById('new-link-title');
    const urlInput = document.getElementById('new-link-url');
    
    if (!titleInput.value || !urlInput.value) {
        alert('Please enter both title and URL');
        return;
    }
    
    let url = urlInput.value;
    if (!url.startsWith('http://') && !url.startsWith('https://')) {
        url = 'https://' + url;
    }
    
    const links = JSON.parse(localStorage.getItem('customLinks')) || [];
    links.push({
        id: Date.now().toString(),
        title: titleInput.value,
        url: url
    });
    
    localStorage.setItem('customLinks', JSON.stringify(links));
    
    titleInput.value = '';
    urlInput.value = '';
    loadCustomLinks();
}

// Remove custom link
function removeCustomLink(id) {
    const links = JSON.parse(localStorage.getItem('customLinks')) || [];
    const updatedLinks = links.filter(link => link.id !== id);
    localStorage.setItem('customLinks', JSON.stringify(updatedLinks));
    loadCustomLinks();
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', loadCustomLinks);
</script>
<div id="shine-particles" style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9998;"></div>
</head>
</html>